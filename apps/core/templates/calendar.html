{% extends layout_path %}

{% load i18n %}

{% block title %}Calendar{% endblock title %}

{% block content %}
<h4 class="py-4 text-center">Calendar {{ current_month_year }}</h4>

<div class="container">
    <div class="calendar">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <button class="btn btn-light" id="prevMonth">&lt;</button>
            <h5 id="monthYear"></h5>
            <button class="btn btn-light" id="nextMonth">&gt;</button>
        </div>
        <table class="table table-bordered text-center">
            <thead class="table-light">
                <tr>
                    <th>Sun</th>
                    <th>Mon</th>
                    <th>Tue</th>
                    <th>Wed</th>
                    <th>Thu</th>
                    <th>Fri</th>
                    <th>Sat</th>
                </tr>
            </thead>
            <tbody id="calendarBody">
                <!-- Calendar dates will be dynamically generated -->
            </tbody>
        </table>
    </div>
</div>

<!-- Styling for the larger calendar -->
<style>
    .calendar {
        max-width: 800px;
        margin: auto;
    }
    .table th, .table td {
        padding: 25px;
        font-size: 18px;
        border: 2px solid #dee2e6; /* Fixed border size */
        border-radius: 10px; /* Keep rounded corners */
        position: relative; /* Needed for absolute positioning of event title */
        transition: box-shadow 0.3s ease; /* Smooth transition for shadow */
    }
    .table td:hover {
        box-shadow: 0 0 10px 2px rgba(0, 123, 255, 0.5), 0 0 20px rgba(0, 123, 255, 0.5); /* Shadow effect around the border on hover */
    }
    .current-day {
        background-color: #cce5ff;
        border-radius: 50%;
        color: #000; /* Keep text color black for the current day */
    }
    .event-title {
        font-size: 14px; /* Adjust font size for the event title */
        color: #ff0000; /* Set the text color for the event title */
        margin-top: 10px; /* Add margin for better spacing */
        overflow: hidden; /* Hide overflow */
        white-space: nowrap; /* Prevent line break */
        text-overflow: ellipsis; /* Show ellipsis if overflow occurs */
        border: 1px solid #ff0000; /* Border for the event title */
        border-radius: 5px; /* Rounded corners for the event title */
        padding: 2px; /* Padding for the event title */
        position: absolute; /* Position absolute to place it correctly */
        bottom: 5px; /* Position it at the bottom of the cell */
        left: 5px; /* Position it slightly from the left */
        right: 5px; /* Position it slightly from the right */
        text-decoration: none; /* Remove underline */
    }
    .event-title:hover {
        text-decoration: underline; /* Add underline on hover */
    }
</style>

<!-- Script to generate the calendar dynamically -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const calendarBody = document.getElementById('calendarBody');
        const monthYear = document.getElementById('monthYear');
        const prevMonth = document.getElementById('prevMonth');
        const nextMonth = document.getElementById('nextMonth');
        let currentDate = new Date();

        function generateCalendar(date) {
            const firstDay = new Date(date.getFullYear(), date.getMonth(), 1).getDay();
            const daysInMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
            calendarBody.innerHTML = '';
            monthYear.innerHTML = date.toLocaleString('default', { month: 'long' }) + ' ' + date.getFullYear();

            let dateCell = 1;
            for (let i = 0; i < 6; i++) {
                let row = document.createElement('tr');
                for (let j = 0; j < 7; j++) {
                    let cell = document.createElement('td');
                    if (i === 0 && j < firstDay) {
                        cell.innerHTML = '';
                    } else if (dateCell > daysInMonth) {
                        cell.innerHTML = '';
                    } else {
                        cell.innerHTML = dateCell;

                        // Check for October 4, 2024
                        if (dateCell === 4 && date.getFullYear() === 2024 && date.getMonth() === 9) { // Month is 0-indexed
                            const eventTitle = document.createElement('a');
                            eventTitle.className = 'event-title';
                            eventTitle.href = "{% url 'event_info' %}"; // Link to the event_info.html
                            eventTitle.innerHTML = 'Basketball League'; // Add the event title
                            cell.appendChild(eventTitle); // Add event title to the cell
                        }

                        if (dateCell === currentDate.getDate() && date.getMonth() === currentDate.getMonth()) {
                            cell.classList.add('current-day');
                        }
                        dateCell++;
                    }
                    row.appendChild(cell);
                }
                calendarBody.appendChild(row);
            }
        }

        generateCalendar(currentDate);

        prevMonth.addEventListener('click', function() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            generateCalendar(currentDate);
        });

        nextMonth.addEventListener('click', function() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            generateCalendar(currentDate);
        });
    });
</script>

{% endblock %}
